<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Syst√®me de Contr√¥le - Accueil</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    :root { color-scheme: light dark; }
    body { margin:0; padding:24px; font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:canvas; color:canvastext; }
    .container { max-width:1200px; margin:0 auto; }
    .header { text-align:center; margin-bottom:40px; }
    .header h1 { margin:0 0 8px; font-size:2rem; }
    .header .subtitle { opacity:.75; font-size:1.1rem; }
    
    .grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:20px; margin:40px 0; }
    .card { 
      padding:24px; 
      border:1px solid color-mix(in oklab, canvastext 15%, transparent); 
      border-radius:16px; 
      background:color-mix(in oklab, canvas 92%, canvastext 0%); 
      box-shadow:0 1px 8px color-mix(in oklab, canvastext 10%, transparent);
      transition:transform .2s ease, box-shadow .2s ease;
      text-decoration:none;
      color:inherit;
    }
    .card:hover { 
      transform:translateY(-2px); 
      box-shadow:0 4px 16px color-mix(in oklab, canvastext 15%, transparent); 
    }
    .card h2 { margin:0 0 8px; font-size:1.3rem; color:dodgerblue; }
    .card .desc { opacity:.8; font-size:.95rem; line-height:1.5; }
    .card .endpoint { 
      margin-top:12px; 
      padding:4px 8px; 
      background:color-mix(in oklab, canvas 85%, canvastext 0%); 
      border-radius:6px; 
      font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; 
      font-size:.85rem; 
      opacity:.7;
    }
    
    .status-section { margin:40px 0; text-align:center; }
    .status-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:16px; margin-top:20px; }
    .status-card { 
      padding:16px; 
      border:1px solid color-mix(in oklab, canvastext 15%, transparent); 
      border-radius:12px; 
      background:color-mix(in oklab, canvas 96%, canvastext 0%); 
    }
    .status-title { font-size:.9rem; opacity:.8; margin-bottom:8px; }
    .status-value { font-size:1.5rem; font-weight:600; }
    .status-online { color:#37b24d; }
    .status-offline { color:#e03131; }
    
    .footer { margin-top:60px; text-align:center; opacity:.6; font-size:.9rem; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üñ•Ô∏è Syst√®me de Contr√¥le</h1>
      <div class="subtitle">Surveillance et monitoring des agents syst√®me</div>
    </div>

    <div class="status-section">
      <h2>√âtat des Agents</h2>
      <div class="status-grid" id="agent-status">
        <div class="status-card">
          <div class="status-title">Agents en ligne</div>
          <div class="status-value status-online" id="online-count">-</div>
        </div>
        <div class="status-card">
          <div class="status-title">Agents hors ligne</div>
          <div class="status-value status-offline" id="offline-count">-</div>
        </div>
        <div class="status-card">
          <div class="status-title">Total agents</div>
          <div class="status-value" id="total-count">-</div>
        </div>
      </div>
    </div>

    <div class="grid">
      <a href="/html/cpus" class="card">
        <h2>üî• Informations CPU</h2>
        <div class="desc">D√©tails sur les processeurs : mod√®le, fr√©quence, cache, flags et caract√©ristiques techniques</div>
        <div class="endpoint">/cpu</div>
      </a>

      <a href="/html/memory" class="card">
        <h2>üíæ M√©moire Syst√®me</h2>
        <div class="desc">Utilisation RAM et SWAP en temps r√©el avec barres de progression et d√©tails techniques</div>
        <div class="endpoint">/mem</div>
      </a>

      <a href="/html/load" class="card">
        <h2>üìä Charge Syst√®me</h2>
        <div class="desc">Load average (1, 5, 15 min) et charge CPU par c≈ìur avec jauges visuelles</div>
        <div class="endpoint">/load + /cpu/load</div>
      </a>

      <a href="/html/procs" class="card">
        <h2>‚öôÔ∏è Processus</h2>
        <div class="desc">Liste compl√®te des processus avec PID, utilisateur, m√©moire, et ligne de commande</div>
        <div class="endpoint">/procs</div>
      </a>

      <a href="/html/nics" class="card">
        <h2>üåê Interfaces R√©seau</h2>
        <div class="desc">D√©bits r√©seau en temps r√©el (Rx/Tx) pour toutes les interfaces actives</div>
        <div class="endpoint">/nics</div>
      </a>

      <a href="/html/disks" class="card">
        <h2>üíø Stockage</h2>
        <div class="desc">Volumes mont√©s, syst√®mes de fichiers et options de montage</div>
        <div class="endpoint">/disks</div>
      </a>

      <a href="/html/agents" class="card">
        <h2>ü§ñ Gestion Agents</h2>
        <div class="desc">Administration et surveillance des agents connect√©s au syst√®me</div>
        <div class="endpoint">/api/agents</div>
      </a>
    </div>

    <div class="footer">
      Syst√®me de contr√¥le ‚Ä¢ Rafra√Æchissement automatique des donn√©es
    </div>
  </div>

  <script>
    async function loadAgentStatus() {
      try {
        const res = await fetch('/api/agents', {headers:{'Accept':'application/json'}});
        if (!res.ok) throw new Error('HTTP ' + res.status);
        const agents = await res.json();
        
        const online = agents.filter(a => a.status === 'online').length;
        const offline = agents.filter(a => a.status === 'offline').length;
        const total = agents.length;
        
        document.getElementById('online-count').textContent = online;
        document.getElementById('offline-count').textContent = offline;
        document.getElementById('total-count').textContent = total;
      } catch (e) {
        document.getElementById('online-count').textContent = '?';
        document.getElementById('offline-count').textContent = '?';
        document.getElementById('total-count').textContent = '?';
      }
    }
    
    loadAgentStatus();
    setInterval(loadAgentStatus, 5000);
  </script>
</body>
</html>